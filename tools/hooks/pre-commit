#!/usr/bin/env bash
set -euo pipefail

# Local hardening: reject any modify/delete/rename/copy under ledger/objects or ledger/nodes.
python tools/check_append_only.py --cached

# Sprint-1 fencepost (Frozen): run verifier when relevant files are staged.
CHANGED="$(git diff --cached --name-only)"
if echo "$CHANGED" | grep -Eq '^(schemas/|canon/|verify/|fixtures/|cli/|pyproject.toml$|requirements\.lock$)'; then
  export PATH="$(pwd)/cli:$PATH"
  nre-verify-fixtures --all
fi
